// Thêm 'useState', 'useRef' từ React
import React, { useState, useRef } from 'react';
import './Collections.css';

const products = [
    {
        id: 1,
        title: "AURORA",
        image: "/collections/pendant.png",
        description: "More than a ring, AURORA is a \ncelebration of light, geometry, and the \nfuture you're building together."
    },
    {
        id: 2,
        title: "SOLARIS",
        image: "/collections/ring1.png",
        description: "A testament to the sun's eternal brilliance, \ncaptured in a timeless design that radiates \nwarmth and elegance."
    },
    {
        id: 3,
        title: "LUNA",
        image: "/collections/earings.png",
        description: "Capturing the serene glow of the moonlight, \nLUNA reflects a story of mystique and \nprofound beauty."
    },
];

function Collections() {
    const section2Ref = useRef(null);
    const section3Ref = useRef(null);

    const [currentIndex, setCurrentIndex] = useState(0);

    // BỎ: Không cần các state phức tạp này nữa
    // const [animationClass, setAnimationClass] = useState('');
    // const [isAnimating, setIsAnimating] = useState(false);

    const handleScrollToSection2 = () => {
        section2Ref.current?.scrollIntoView({ behavior: 'smooth' });
    };

    const handleScrollToSection3 = () => {
        section3Ref.current?.scrollIntoView({ behavior: 'smooth' });
    };

    // MỚI: Hàm handleNext được đơn giản hóa tối đa
    const handleNext = () => {
        setCurrentIndex((prevIndex) => (prevIndex + 1) % products.length);
    };

    // MỚI: Hàm handlePrevious được đơn giản hóa tối đa
    const handlePrevious = () => {
        setCurrentIndex((prevIndex) => (prevIndex - 1 + products.length) % products.length);
    };

    const currentProduct = products[currentIndex];

    return (
        <div className="collection-page">
            {/* --- SECTION 1 --- (Không thay đổi) */}
            <div className='section-1'>
                <div className="hero-text-container">
                    <div className="text-treasure">TREASURE</div>
                    <div className="text-of-the">of the</div>
                    <div className="text-orient">ORIENT</div>
                </div>

                <button
                    className="scroll-down-arrow"
                    onClick={handleScrollToSection2}
                    aria-label="Scroll down"
                >
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19 9L12 16L5 9" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" />
                    </svg>
                </button>
            </div>

            {/* --- SECTION 2 --- */}
            <div className="section-2" ref={section2Ref}>
                <div className="collection-image-panel">
                    <img
                        src="/collections/ring.png"
                        alt="Jewelry collection mood"
                    />
                </div>

                <div className="collection-content-panel">
                    <div className="product-slider">
                        <div className="slider-main-row">
                            <button className="slider-arrow" aria-label="Previous Product" onClick={handlePrevious}>
                                <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M23.75 15L6.25 15M6.25 15L13.75 7.5M6.25 15L13.75 22.5" stroke="white" strokeWidth="2" strokeLinecap="square" />
                                </svg>
                            </button>

                            {/* MỚI: Áp dụng class 'slide-effect' và quan trọng nhất là 'key' */}
                            <div className="product-image-container slide-effect" key={currentProduct.id}>
                                <img
                                    src={currentProduct.image}
                                    alt={currentProduct.title}
                                    className="product-image"
                                />
                            </div>

                            <button className="slider-arrow" aria-label="Next Product" onClick={handleNext}>
                                <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M6.25 15L23.75 15M23.75 15L16.25 22.5M23.75 15L16.25 7.5" stroke="white" strokeWidth="2" strokeLinecap="square" />
                                </svg>
                            </button>
                        </div>

                        {/* MỚI: Áp dụng tương tự cho phần thông tin sản phẩm */}
                        <div className="product-info slide-effect" key={currentProduct.id + '-info'}>
                            <h2 className="product-title">{currentProduct.title}</h2>
                            <p className="product-description">
                                {
                                    currentProduct.description.split('\n').map((line, index) => (
                                        <React.Fragment key={index}>
                                            {line}
                                            {index < currentProduct.description.split('\n').length - 1 && <br />}
                                        </React.Fragment>
                                    ))
                                }
                            </p>
                            <button className="explore-button">
                                <svg width="164" height="50" viewBox="0 0 164 50" fill="none" xmlns="http://www.w3.org/2000/svg" className="explore-gem-svg">
                                    <path className="button-background" d="M9 1 L155 1 L163 10 L163 41 L155 49 L9 49 L1 40 L1 9 Z" fill="transparent" />
                                    <path className="button-border" d="M9 1 L155 1 L163 10 L163 41 L155 49 L9 49 L1 40 L1 9 Z" stroke="black" fill="none" />
                                    <path className="button-text" d="M26.3612 19.86H32.0732V21.036H27.7052V24.452H31.7372V25.628H27.7052V29.324H32.1292V30.5H26.3612V19.86ZM36.1832 26.58V26.524L33.7612 22.94H35.3292L36.9812 25.516H37.0372L38.7452 22.94H40.2012L37.7792 26.538V26.594L40.4112 30.5H38.8432L36.9672 27.672H36.9112L34.9792 30.5H33.4672L36.1832 26.58ZM41.8078 22.94H43.0958V23.976H43.1518C43.4038 23.612 43.7725 23.318 44.2578 23.094C44.7525 22.8607 45.2518 22.744 45.7558 22.744C46.4091 22.744 47.0205 22.898 47.5898 23.206C48.1685 23.514 48.6305 23.9713 48.9758 24.578C49.3305 25.1753 49.5078 25.8847 49.5078 26.706C49.5078 27.462 49.3351 28.1433 48.9898 28.75C48.6538 29.3473 48.1918 29.8187 47.6038 30.164C47.0158 30.5 46.3671 30.668 45.6578 30.668C45.1071 30.668 44.5938 30.5607 44.1178 30.346C43.6511 30.122 43.3291 29.8373 43.1518 29.492H43.0958V33.58H41.8078V22.94ZM43.0398 26.706C43.0398 27.2287 43.1471 27.7047 43.3618 28.134C43.5858 28.554 43.8891 28.8853 44.2718 29.128C44.6638 29.3707 45.1071 29.492 45.6018 29.492C46.0965 29.492 46.5351 29.3707 46.9178 29.128C47.3098 28.8853 47.6131 28.554 47.8278 28.134C48.0518 27.7047 48.1638 27.2287 48.1638 26.706C48.1638 26.1833 48.0518 25.712 47.8278 25.292C47.6131 24.8627 47.3098 24.5267 46.9178 24.284C46.5351 24.0413 46.0965 23.92 45.6018 23.92C45.1071 23.92 44.6638 24.0413 44.2718 24.284C43.8891 24.5267 43.5858 24.8627 43.3618 25.292C43.1471 25.712 43.0398 26.1833 43.0398 26.706ZM52.5346 30.5C51.4893 30.5 50.9666 29.9773 50.9666 28.932V19.58H52.2546V28.4C52.2546 28.7547 52.32 28.9973 52.4506 29.128C52.5813 29.2587 52.7866 29.324 53.0666 29.324H53.8226V30.5H52.5346ZM58.1831 30.668C57.5111 30.668 56.8811 30.5093 56.2931 30.192C55.7051 29.8653 55.2291 29.4033 54.8651 28.806C54.5104 28.2087 54.3331 27.5087 54.3331 26.706C54.3331 25.9127 54.5058 25.2173 54.8511 24.62C55.2058 24.0133 55.6771 23.5513 56.2651 23.234C56.8531 22.9073 57.4924 22.744 58.1831 22.744C58.8551 22.744 59.4851 22.9073 60.0731 23.234C60.6611 23.5513 61.1324 24.0087 61.4871 24.606C61.8511 25.2033 62.0331 25.9033 62.0331 26.706C62.0331 27.4993 61.8558 28.1993 61.5011 28.806C61.1558 29.4033 60.6891 29.8653 60.1011 30.192C59.5131 30.5093 58.8738 30.668 58.1831 30.668ZM55.6771 26.706C55.6771 27.2287 55.7798 27.7047 55.9851 28.134C56.1998 28.554 56.4938 28.8853 56.8671 29.128C57.2498 29.3707 57.6884 29.492 58.1831 29.492C58.6778 29.492 59.1118 29.3707 59.4851 29.128C59.8678 28.8853 60.1618 28.554 60.3671 28.134C60.5818 27.7047 60.6891 27.2287 60.6891 26.706C60.6891 26.1833 60.5818 25.712 60.3671 25.292C60.1618 24.8627 59.8678 24.5267 59.4851 24.284C59.1118 24.0413 58.6778 23.92 58.1831 23.92C57.6884 23.92 57.2498 24.0413 56.8671 24.284C56.4938 24.5267 56.1998 24.8627 55.9851 25.292C55.7798 25.712 55.6771 26.1833 55.6771 26.706ZM63.4914 22.94H64.7794V24.004H64.8354C64.9287 23.6493 65.1247 23.3647 65.4234 23.15C65.7314 22.9353 66.1514 22.828 66.6834 22.828H67.4674V24.06H66.6834C65.9741 24.06 65.4794 24.2373 65.1994 24.592C64.9194 24.9373 64.7794 25.4693 64.7794 26.188V30.5H63.4914V22.94ZM71.6512 30.668C70.8579 30.668 70.1672 30.5047 69.5792 30.178C68.9912 29.842 68.5385 29.3753 68.2212 28.778C67.9039 28.1807 67.7452 27.49 67.7452 26.706C67.7452 25.95 67.9132 25.2733 68.2492 24.676C68.5852 24.0693 69.0425 23.598 69.6212 23.262C70.1999 22.9167 70.8392 22.744 71.5392 22.744C72.2579 22.744 72.8879 22.9027 73.4292 23.22C73.9705 23.528 74.3905 23.9807 74.6892 24.578C74.9879 25.1753 75.1372 25.894 75.1372 26.734C75.1372 26.8927 75.1325 27.0047 75.1232 27.07H69.0892C69.1359 27.7887 69.3972 28.372 69.8732 28.82C70.3585 29.268 70.9885 29.492 71.7632 29.492C72.2299 29.492 72.6359 29.4127 72.9812 29.254C73.3265 29.086 73.6345 28.8387 73.9052 28.512L74.7312 29.31C74.4045 29.73 73.9799 30.0613 73.4572 30.304C72.9345 30.5467 72.3325 30.668 71.6512 30.668ZM73.8072 26.062C73.7699 25.4367 73.5365 24.9233 73.1072 24.522C72.6779 24.1207 72.1552 23.92 71.5392 23.92C70.8952 23.92 70.3445 24.1207 69.8872 24.522C69.4299 24.914 69.1732 25.4273 69.1172 26.062H73.8072ZM82.1382 30.5C81.0929 30.5 80.5702 29.9773 80.5702 28.932V23.948H79.9542V22.94H80.5702V21.148H81.8582V22.94H83.9862V23.948H81.8582V28.4C81.8582 28.7547 81.9235 28.9973 82.0542 29.128C82.1849 29.2587 82.3902 29.324 82.6702 29.324H83.9862V30.5H82.1382ZM85.3254 19.58H86.6134V24.004H86.6694C86.856 23.6493 87.1594 23.3553 87.5794 23.122C88.0087 22.8887 88.494 22.772 89.0354 22.772C89.9594 22.772 90.7014 23.066 91.2614 23.654C91.8214 24.2327 92.1014 25.054 92.1014 26.118V30.5H90.8134V26.258C90.8134 25.5767 90.622 25.012 90.2394 24.564C89.866 24.116 89.3667 23.892 88.7414 23.892C88.3494 23.892 87.99 24.004 87.6634 24.228C87.3367 24.4427 87.08 24.7507 86.8934 25.152C86.7067 25.5533 86.6134 26.0107 86.6134 26.524V30.5H85.3254V19.58ZM94.0617 22.94H95.3497V30.5H94.0617V22.94ZM93.8937 21.344C93.8937 21.12 93.973 20.9287 94.1317 20.77C94.2904 20.6113 94.4817 20.532 94.7057 20.532C94.9297 20.532 95.121 20.6113 95.2797 20.77C95.4384 20.9287 95.5177 21.12 95.5177 21.344C95.5177 21.568 95.4384 21.7593 95.2797 21.918C95.121 22.0767 94.9297 22.156 94.7057 22.156C94.4817 22.156 94.2904 22.0767 94.1317 21.918C93.973 21.7593 93.8937 21.568 93.8937 21.344ZM99.8399 30.668C99.3732 30.668 98.9299 30.6073 98.5099 30.486C98.0992 30.3647 97.7492 30.22 97.4599 30.052C97.1705 29.884 96.9699 29.73 96.8579 29.59L97.7819 28.666C97.9592 28.8807 98.2485 29.072 98.6499 29.24C99.0512 29.408 99.4759 29.492 99.9239 29.492C100.437 29.492 100.825 29.3893 101.086 29.184C101.347 28.9693 101.478 28.708 101.478 28.4C101.478 28.1293 101.375 27.896 101.17 27.7C100.965 27.4947 100.689 27.35 100.344 27.266L99.3359 27.014C98.6265 26.8273 98.0712 26.5893 97.6699 26.3C97.2685 26.0107 97.0679 25.5627 97.0679 24.956C97.0679 24.5547 97.1892 24.186 97.4319 23.85C97.6839 23.514 98.0292 23.248 98.4679 23.052C98.9065 22.8467 99.3965 22.744 99.9379 22.744C100.629 22.744 101.217 22.8793 101.702 23.15C102.187 23.4113 102.537 23.7007 102.752 24.018L101.968 24.802C101.8 24.578 101.539 24.368 101.184 24.172C100.829 23.9667 100.409 23.864 99.9239 23.864C99.4572 23.864 99.0885 23.962 98.8179 24.158C98.5472 24.3447 98.4119 24.5687 98.4119 24.83C98.4119 25.0633 98.5052 25.2547 98.6919 25.404C98.8879 25.544 99.2099 25.67 99.6579 25.782L100.484 25.992C101.203 26.1787 101.772 26.4493 102.192 26.804C102.612 27.1587 102.822 27.6487 102.822 28.274C102.822 28.722 102.705 29.128 102.472 29.492C102.239 29.856 101.893 30.1453 101.436 30.36C100.988 30.5653 100.456 30.668 99.8399 30.668ZM111.781 33.748C110.95 33.748 110.236 33.5847 109.639 33.258C109.042 32.9313 108.524 32.488 108.085 31.928L108.981 31.032C109.774 32.0213 110.689 32.516 111.725 32.516C112.546 32.516 113.158 32.3013 113.559 31.872C113.96 31.452 114.161 30.9107 114.161 30.248V29.492H114.105C113.881 29.828 113.526 30.108 113.041 30.332C112.565 30.556 112.084 30.668 111.599 30.668C110.834 30.668 110.157 30.5047 109.569 30.178C108.99 29.842 108.542 29.3753 108.225 28.778C107.908 28.1713 107.749 27.4807 107.749 26.706C107.749 25.9033 107.917 25.2033 108.253 24.606C108.598 23.9993 109.06 23.5373 109.639 23.22C110.218 22.9027 110.857 22.744 111.557 22.744C112.089 22.744 112.579 22.856 113.027 23.08C113.484 23.304 113.844 23.6027 114.105 23.976H114.161V22.94H115.449V30.444C115.449 31.06 115.309 31.6153 115.029 32.11C114.749 32.614 114.329 33.0107 113.769 33.3C113.218 33.5987 112.556 33.748 111.781 33.748ZM109.093 26.706C109.093 27.2287 109.2 27.7047 109.415 28.134C109.639 28.554 109.942 28.8853 110.325 29.128C110.717 29.3707 111.16 29.492 111.655 29.492C112.15 29.492 112.588 29.3707 112.971 29.128C113.363 28.8853 113.666 28.554 113.881 28.134C114.105 27.7047 114.217 27.2287 114.217 26.706C114.217 26.1833 114.105 25.712 113.881 25.292C113.666 24.8627 113.363 24.5267 112.971 24.284C112.588 24.0413 112.15 23.92 111.655 23.92C111.16 23.92 110.717 24.0413 110.325 24.284C109.942 24.5267 109.639 24.8627 109.415 25.292C109.2 25.712 109.093 26.1833 109.093 26.706ZM120.706 30.668C119.913 30.668 119.222 30.5047 118.634 30.178C118.046 29.842 117.593 29.3753 117.276 28.778C116.959 28.1807 116.8 27.49 116.8 26.706C116.8 25.95 116.968 25.2733 117.304 24.676C117.64 24.0693 118.097 23.598 118.676 23.262C119.255 22.9167 119.894 22.744 120.594 22.744C121.313 22.744 121.943 22.9027 122.484 23.22C123.025 23.528 123.445 23.9807 123.744 24.578C124.043 25.1753 124.192 25.894 124.192 26.734C124.192 26.8927 124.187 27.0047 124.178 27.07H118.144C118.191 27.7887 118.452 28.372 118.928 28.82C119.413 29.268 120.043 29.492 120.818 29.492C121.285 29.492 121.691 29.4127 122.036 29.254C122.381 29.086 122.689 28.8387 122.96 28.512L123.786 29.31C123.459 29.73 123.035 30.0613 122.512 30.304C121.989 30.5467 121.387 30.668 120.706 30.668ZM122.862 26.062C122.825 25.4367 122.591 24.9233 122.162 24.522C121.733 24.1207 121.21 23.92 120.594 23.92C119.95 23.92 119.399 24.1207 118.942 24.522C118.485 24.914 118.228 25.4273 118.172 26.062H122.862ZM125.821 22.94H127.109V24.004H127.165C127.361 23.6307 127.669 23.332 128.089 23.108C128.509 22.884 128.981 22.772 129.503 22.772C130.063 22.772 130.563 22.9073 131.001 23.178C131.44 23.4487 131.785 23.836 132.037 24.34H132.093C132.663 23.2947 133.559 22.772 134.781 22.772C135.733 22.772 136.475 23.066 137.007 23.654C137.539 24.2327 137.805 25.054 137.805 26.118V30.5H136.517V26.258C136.517 25.5487 136.34 24.9793 135.985 24.55C135.64 24.1113 135.164 23.892 134.557 23.892C133.913 23.892 133.4 24.13 133.017 24.606C132.644 25.0727 132.457 25.712 132.457 26.524V30.5H131.169V26.258C131.169 25.5487 130.992 24.9793 130.637 24.55C130.292 24.1113 129.816 23.892 129.209 23.892C128.565 23.892 128.052 24.13 127.669 24.606C127.296 25.0727 127.109 25.712 127.109 26.524V30.5H125.821V22.94Z" fill="black" />
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <button
                    className="scroll-down-arrow"
                    onClick={handleScrollToSection3}
                    aria-label="Scroll to section 3"
                >
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19 9L12 16L5 9" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" />
                    </svg>
                </button>
            </div>

            {/* --- SECTION 3 --- (Không thay đổi) */}
            <div className="section-3" ref={section3Ref}>
                <h2 className="mirror-collection-title">Mirror Collection 3</h2>
            </div>
        </div>
    );
}

export default Collections;